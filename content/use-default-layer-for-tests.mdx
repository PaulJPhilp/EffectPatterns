---
title: "Use the Auto-Generated .Default Layer in Tests"
id: "use-default-layer-for-tests"
skillLevel: "intermediate"
useCase: ["Testing"]
summary: "When testing, always use the MyService.Default layer that is automatically generated by the Effect.Service class for dependency injection."
tags: ["testing", "service", "layers", "dependency-injection"]
rule:
  description: "Use the auto-generated .Default layer in tests."
related: ["define-service-with-effect-service", "test-the-code-as-is"]
author: "Paul Philp"
---

# Use the Auto-Generated .Default Layer in Tests

## Guideline

In your tests, provide service dependencies using the static `.Default` property that `Effect.Service` automatically attaches to your service class.

## Rationale

The `.Default` layer is the canonical way to provide a service in a test environment. It's automatically created, correctly scoped, and handles resolving any transitive dependencies, making tests cleaner and more robust.

## Good Example

```typescript
import { Effect } from "effect";
import { describe, expect, it } from "vitest";
import { MyService } from "../MyService";

describe("MyService", () => {
  it("should perform its operation", () =>
    Effect.gen(function* () {
      const service = yield* MyService;
      const result = yield* service.doSomething();
      expect(result).toBe("done");
    }).pipe(
      Effect.provide(MyService.Default), // âœ… Correct
      Effect.runPromise,
    ));
});
```

**Explanation:**  
This approach ensures your tests are idiomatic, maintainable, and take full advantage of Effect's dependency injection system.

## Anti-Pattern

Do not create manual layers for your service in tests (`Layer.succeed(...)`) or try to provide the service class directly. This bypasses the intended dependency injection mechanism.
